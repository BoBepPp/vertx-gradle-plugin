apply plugin: 'vertx'

def vertxVersion = '2.1'

vertx {
  platform {
    version vertxVersion
  }

  config {
    main 'Main'
  }

  deployments {
    mod {
      platform {
        instances 10
      }
    }
  }
}

import com.darylteo.vertx.gradle.tasks.*;

afterEvaluate {
  assert vertx != null
  assert vertx.platform != null
  assert vertx.platform.version == vertxVersion

  assert vertx.config != null
  assert vertx.config.map.main == 'Main'

  assert vertx.deployments != null
  assert vertx.deployments.mod != null

  assert (project.tasks.runMod instanceof VertxRun)

  assert project.configurations.vertxCore != null

  assert project.configurations.vertxCore.files.find({ file ->
    file.name == "vertx-platform-${vertxVersion}.jar"
  }) != null
}